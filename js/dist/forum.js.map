{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@michaelbelgium/flarum-discussion-views/./src/forum/components/AddLists.js","webpack://@michaelbelgium/flarum-discussion-views/./src/forum/components/AddModerationControl.js","webpack://@michaelbelgium/flarum-discussion-views/./src/forum/components/AddPopularSort.js","webpack://@michaelbelgium/flarum-discussion-views/./src/forum/components/AddViewsToModelAndDisplay.js","webpack://@michaelbelgium/flarum-discussion-views/./src/forum/components/PostDiscussionViewsModal.js","webpack://@michaelbelgium/flarum-discussion-views/./src/forum/components/ResetDiscussionViewsModal.js","webpack://@michaelbelgium/flarum-discussion-views/./src/forum/index.js","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['Model']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['app']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/Button']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/CommentPost']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/DiscussionList']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/DiscussionListItem']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/DiscussionPage']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/FieldSet']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/Link']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['components/Modal']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['extend']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['helpers/avatar']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['helpers/icon']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['helpers/punctuateSeries']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['helpers/username']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['models/Discussion']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['states/DiscussionListState']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['utils/DiscussionControls']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['utils/ItemList']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['utils/abbreviateNumber']\"","webpack://@michaelbelgium/flarum-discussion-views/external root \"flarum.core.compat['utils/humanTime']\"","webpack://@michaelbelgium/flarum-discussion-views/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@michaelbelgium/flarum-discussion-views/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@michaelbelgium/flarum-discussion-views/webpack/bootstrap","webpack://@michaelbelgium/flarum-discussion-views/webpack/runtime/compat get default export","webpack://@michaelbelgium/flarum-discussion-views/webpack/runtime/define property getters","webpack://@michaelbelgium/flarum-discussion-views/webpack/runtime/hasOwnProperty shorthand","webpack://@michaelbelgium/flarum-discussion-views/webpack/runtime/make namespace object","webpack://@michaelbelgium/flarum-discussion-views/./forum.js"],"sourcesContent":["import { extend } from 'flarum/extend';\nimport username from 'flarum/helpers/username';\nimport icon from 'flarum/helpers/icon';\nimport punctuateSeries from 'flarum/helpers/punctuateSeries';\nimport avatar from 'flarum/helpers/avatar';\nimport ItemList from 'flarum/utils/ItemList';\nimport humanTime from 'flarum/utils/humanTime';\nimport CommentPost from 'flarum/components/CommentPost';\nimport Link from 'flarum/components/Link';\nimport DiscussionPage from 'flarum/components/DiscussionPage';\nimport FieldSet from 'flarum/components/FieldSet';\nimport PostDiscussionViewsModal from '../components/PostDiscussionViewsModal';\n\nexport default function () {\n    extend(DiscussionPage.prototype, 'sidebarItems', function(items) {\n        if(app.forum.attribute('showViewList') == 0) return;\n        \n        const views = this.discussion.views();\n        const viewList = new ItemList();\n\n        $.each(views, function(key, view) {\n            var userName = view.user() === false ? app.translator.trans('michaelbelgium-discussion-views.forum.viewlist.guest') : view.user().username();\n\n            var listitem = \n                <div className=\"item-lastUser-content\">\n                    {avatar(view.user())}\n                    <div>\n                        {userName}\n                        <span className=\"lastUser-visited\" title={view.visitedAt().toLocaleString()}>{humanTime(view.visitedAt())}</span>\n                    </div>\n                </div>;\n\n            if(view.user() !== false) {\n                listitem = <Link href={app.route.user(view.user())}>{listitem}</Link>;\n            }\n\n            viewList.add('lastUser-' + key, listitem);\n        });\n\n        items.add(\n            'lastDiscussionViewers', \n            <FieldSet className='LastDiscussionUsers' label={app.translator.trans('michaelbelgium-discussion-views.forum.viewlist.title')}>\n                {viewList.toArray()}\n            </FieldSet>\n        );\n    });\n\n    extend(CommentPost.prototype, 'footerItems', function(items) {\n        if(app.forum.attribute('showFooterViewList') == 0) return;\n        \n        const post = this.attrs.post;\n        const discussion = post.discussion();\n        const views = discussion.uniqueViews();\n\n        if(discussion.posts() === false || discussion.posts().length == 0) return;\n        const firstPostId = discussion.posts()[0].id();\n\n        if(firstPostId === post.id()) {\n            if(views && views.length > 0) {\n                const limit = 5;\n\n                const names = views.slice(0, limit).map(view => {\n                    return (\n                        <Link href={app.route.user(view.user())}>\n                            {view.user() === app.session.user ? app.translator.trans('michaelbelgium-discussion-views.forum.post.you') : username(view.user())}\n                        </Link>\n                    )\n                });\n\n                if(views.length > limit)\n                {\n                    const count = views.length - limit;\n\n                    names.push(\n                        <Link href=\"#\" onclick={e => {\n                            e.preventDefault();\n                            app.modal.show(PostDiscussionViewsModal, {post});\n                        }}>\n                            {app.translator.trans('michaelbelgium-discussion-views.forum.post.others_link', {count})}\n                        </Link>\n                    );\n                }\n\n                if(names.length > 0) {\n                    items.add('viewed', (\n                        <div className=\"Post-Discussion-viewedBy\">\n                            {icon('fas fa-eye')}\n                            {app.translator.trans('michaelbelgium-discussion-views.forum.post.viewed_by', {\n                                users: punctuateSeries(names)\n                            })}\n                        </div>\n                    ));\n                }\n            }    \n        }\n    });\n}","import { extend } from 'flarum/extend';\nimport Button from 'flarum/components/Button';\nimport DiscussionControls from 'flarum/utils/DiscussionControls';\nimport ResetDiscussionViewsModal from './ResetDiscussionViewsModal';\n\nexport default function () {\n    extend(DiscussionControls, 'moderationControls', function(items, discussion) {\n        if(discussion.canReset() && discussion.viewCount() > 0)\n        {\n            items.add(\n                'reset',\n                <Button icon='far fa-eye-slash' onclick={() => app.modal.show(ResetDiscussionViewsModal, { discussion })}>\n                    {app.translator.trans('michaelbelgium-discussion-views.forum.discussion_controls.resetviews_button')}\n                </Button>\n            );\n        }\n    });\n}\n","import { extend } from 'flarum/extend';\nimport DiscussionListState from 'flarum/states/DiscussionListState'\n\nexport default function () {\n    extend(DiscussionListState.prototype, 'sortMap', function (map) {\n        if(app.forum.attribute('toggleFilter') == 1) {\n            map.popular = '-view_count';\n            map.unpopular = 'view_count';\n        }\n    });\n}\n","import { extend } from 'flarum/extend';\nimport Model from 'flarum/Model';\nimport Discussion from 'flarum/models/Discussion';\nimport DiscussionListItem from 'flarum/components/DiscussionListItem';\nimport DiscussionList from 'flarum/components/DiscussionList';\nimport abbreviateNumber from 'flarum/utils/abbreviateNumber';\nimport app from 'flarum/app';\n\nexport default function () {\n    Discussion.prototype.views = Model.hasMany('latestViews');\n    Discussion.prototype.uniqueViews = Model.hasMany('uniqueViews');\n    Discussion.prototype.canReset = Model.attribute('canReset');\n    Discussion.prototype.canViewNumber = Model.attribute('canViewNumber');\n    Discussion.prototype.viewCount = Model.attribute('viewCount');\n\n    extend(DiscussionListItem.prototype, 'infoItems', function(items) {\n        if(this.attrs.discussion.canViewNumber()) {\n            const views = this.attrs.discussion.viewCount();\n\n            var number = app.forum.attribute('abbrNumber') == 1 ? abbreviateNumber(views) : views;\n            items.add('discussion-views', <span>{number}</span>);   \n        }\n    });\n\n    extend(DiscussionList.prototype, 'requestParams', function(params) {\n        params.include.push('latestViews'); //fixes not loading relationship when navigating back to the discussion list if you directly went to a discussion or another page\n    })\n}\n","import Modal from 'flarum/common/components/Modal';\nimport Link from 'flarum/components/Link';\nimport username from 'flarum/helpers/username';\nimport avatar from 'flarum/helpers/avatar';\n\nexport default class PostDiscussionViewsModal extends Modal {\n  className() {\n    return 'Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('michaelbelgium-discussion-views.forum.post.modal_title_text');\n  }\n\n  content() {\n    const views = this.attrs.post.discussion().uniqueViews();\n\n    const names = views.map(view => {\n      const user = view.user();\n\n      return (<li>\n          <Link href={app.route.user(user)}>\n              {avatar(user)} {' '}\n              {username(user)}\n          </Link>\n      </li>)\n    });\n\n    return (\n        <div className=\"Modal-body\">\n            <ul className=\"PostLikesModal-list\">\n                {names}\n            </ul>\n        </div>\n    );\n  }\n}\n","import Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\n\nexport default class ResetDiscussionViewsModal extends Modal {\n    oninit(vnode)\n    {\n        super.oninit(vnode);\n\n        this.discussion = this.attrs.discussion;\n        this.currentViewsCount = this.discussion.viewCount();\n    }\n\n    content()\n    {\n        return (\n            <div className=\"Modal-body\">\n                <div className=\"Form Form--centered\">\n                    <p>{app.translator.trans('michaelbelgium-discussion-views.forum.modal_resetviews.label', {count: this.currentViewsCount })}</p>\n                    <div className=\"Form-group\">\n                        {Button.component(\n                            {\n                                className: 'Button Button--primary Button--block',\n                                type: 'submit',\n                                loading: this.loading\n                            }, \n                            app.translator.trans('michaelbelgium-discussion-views.forum.modal_resetviews.submit_button')\n                        )}\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    title()\n    {\n        return app.translator.trans('michaelbelgium-discussion-views.forum.modal_resetviews.title');\n    }\n\n    className()\n    {\n        return 'Modal--small';\n    }\n\n    onsubmit(e)\n    {\n        e.preventDefault();\n        this.loading = true;\n\n        this.attrs.discussion\n            .save({ resetViews: true })\n            .catch(() => {\n                this.loaded();\n            });\n\n        this.hide();\n    }\n}\n","import app from 'flarum/app';\nimport AddPopularSort from './components/AddPopularSort';\nimport AddViewsToModelAndDisplay from './components/AddViewsToModelAndDisplay';\nimport AddModerationControl from './components/AddModerationControl';\nimport AddLists from './components/AddLists';\n\napp.initializers.add('michaelbelgium-discussion-views', function () {\n    AddPopularSort();\n    AddViewsToModelAndDisplay();\n    AddModerationControl();\n    AddLists();\n});\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/CommentPost'];","module.exports = flarum.core.compat['components/DiscussionList'];","module.exports = flarum.core.compat['components/DiscussionListItem'];","module.exports = flarum.core.compat['components/DiscussionPage'];","module.exports = flarum.core.compat['components/FieldSet'];","module.exports = flarum.core.compat['components/Link'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/avatar'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['helpers/punctuateSeries'];","module.exports = flarum.core.compat['helpers/username'];","module.exports = flarum.core.compat['models/Discussion'];","module.exports = flarum.core.compat['states/DiscussionListState'];","module.exports = flarum.core.compat['utils/DiscussionControls'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/abbreviateNumber'];","module.exports = flarum.core.compat['utils/humanTime'];","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export * from './src/forum';\n"],"names":["extend","username","icon","punctuateSeries","avatar","ItemList","humanTime","CommentPost","Link","DiscussionPage","FieldSet","PostDiscussionViewsModal","prototype","items","app","forum","attribute","views","discussion","viewList","$","each","key","view","userName","user","translator","trans","listitem","m","className","title","visitedAt","toLocaleString","href","route","add","label","toArray","post","attrs","uniqueViews","posts","length","firstPostId","id","limit","names","slice","map","session","count","push","onclick","e","preventDefault","modal","show","users","Button","DiscussionControls","ResetDiscussionViewsModal","canReset","viewCount","DiscussionListState","popular","unpopular","Model","Discussion","DiscussionListItem","DiscussionList","abbreviateNumber","hasMany","canViewNumber","number","params","include","Modal","_Modal","_inheritsLoose","apply","arguments","_proto","content","default","oninit","vnode","call","currentViewsCount","component","type","loading","onsubmit","_this","save","resetViews","loaded","hide","AddPopularSort","AddViewsToModelAndDisplay","AddModerationControl","AddLists","initializers","setPrototypeOf","subClass","superClass","Object","create","constructor","_setPrototypeOf","o","p","bind","__proto__"],"sourceRoot":""}